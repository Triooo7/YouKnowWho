		pipeline {
	agent none

	stages	{
	stage('unit Tests')
			{
	agent 	{
	label 'apache'
		}

	steps {
		sh 'ant -f test.xml -v'
		junit 'reports/result.xml'
		}
			}
	stage('build') 	{
	agent{
		label 'apache'
		}
	steps {
		sh 'ant -f build.xml -v'
		}
	post {
		success {
	archiveArtifacts artifacts: 'dist/*.jar', fingerprint: true
		}
			}
				}
	stage('deploy') {
	agent {
		label 'apache'
		}

	steps {
		sh "cp dist/rectangle_\$\{env.MAJOR_VERSION\}.28.jar /var/www/html/rectangles/all/"
		}
			}
	stage ("Running on Centos") {
	agent{
		label 'Centos'
		}
	steps {
		sh "wget http://rohithraju1.mylabserver.com/rectangles/all/rectangle_${env.BUILD_NUMBER}.jar 3 4"
		}
				}
	stage("Test on Debian"){
	agent{
		docker 'openjdk:8u121-jre'
		}
	steps {
		sh "wget http://rohithraju1.mylabserver.cpm/rectangles/all/rectangle_${env.BUILD_NUMBER}.jar"
		sh"java -jar rectangle ${env.BUILD_NUMBER}.jar 3 4"
		}
			}
				}
					}
